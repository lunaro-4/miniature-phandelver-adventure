---
is_haggled: false
is_friend: false
trader_greed: 1.25
trader_normal: 1
trader_good: 0.75
---
> Над дверью этой скромной лавки висит деревянный знак в форме щита с нарисованным на нём синим львом.


Магазин львиный щит — центральный торговый пост в Фандалине. Его стеллажи заполнены, по большей части, обычным товаром и материалами, включая заплечные сумки, походные кровати, верёвки, дорожные пайки. Это место открыто с рассвета до заката. Персонажи могут приобрести здесь любое снаряжение.

Владелец магазина - [[▶️ Campaigns/vika-dasha-lmop/npcs/Эльмар-Бартен|Эльмар-Бартен]]. В подсобке он хранит запас доспехов и оружия, который предусмотрен на продажу заинтересованным покупателям. Однако совесть не позволит ему продать оружие тем, кто по её мнению может представлять угрозу городу. Среди тех, с кем Бартен отказался вести дела, оказались Красноклеймённые. Он предупреждает персонажей о том, что головорезы опасны, и советует обходить стороной трактир Спящий великан.



# Ассортимент

## Общее

```dataviewjs

let equipment = await dv.io.csv("Mechanics/equipment.csv")
let weapons = await dv.io.csv("Mechanics/weapons.csv")
let armor = await dv.io.csv("Mechanics/armor.csv")
let my_csv = equipment

const page = dv.current()
const is_haggled = page.is_haggled
const is_friend =page.is_friend
const trader_greed = page.trader_greed
const trader_normal = page.trader_normal
const trader_good = page.trader_good


const nominal = { 
	copper: "мм",
	silver: "см",
	electrum: "эм",
	gold: "зм",
	plat: "пм"
}



// 
function eval_copper_price(price, nom) {
	switch (nom) {
		case "мм":
			return price
		case "см":
			return price *10
		case "эм": 
			return price *50
		case "зм":
			return price *100
		case "пм":
			return price * 1000
		default:
			return 0
	}
}

function format_price(price, nom) {
	if (price == 0){ return ""}
	price = Math.floor(price)
	return price.toString() + " " + nom
}


function price_stringify(price, nom) {
	price = Math.ceil(price)
	switch (nom) {
		case nominal.copper:
			return format_price(price, nom)
		case nominal.silver:
			return format_price(price/10 , nom) + " " + format_price(price %10, nominal.copper)
		case nominal.electrum: 
			return format_price(price/50 , nom) + " " + format_price(price % 50, nominal.copper)
		case nominal.gold:
			return format_price(price/100 , nom) + " " + format_price(price %100, nominal.silver)
		case nominal.platium:
			return format_price(price/1000 , nom) + " " + format_price(price %1000, nominal.gold)
		default:
			return 0
	}
}

function filter_for_trader(item_dict){

if (item_dict.price > 2500) {return false}
if (!item_dict.category == "No cat") {return false}
return true

}

function get_values(dict) {

	
	const item = dict.item
	const nom = dict.nom
	const weight = dict.weight
	let price = dict.price
	let copper_price = eval_copper_price(price, nom)
	
	if (!filter_for_trader({price: copper_price})) {return []}

	let trader_state_modifier = trader_greed
	if (is_friend) {trader_state_modifier = trader_good}
	else if (is_haggled){trader_state_modifier = trader_normal}
	
	const final_price = price_stringify(copper_price* trader_state_modifier, nom)

	let starting_price = price_stringify(copper_price*trader_greed, nom)
	let normal_price = price_stringify(copper_price*trader_normal, nom)
	let lowest_price = price_stringify(copper_price*trader_good,nom)
	return [item, final_price]
}

for (let group of my_csv.groupBy(p => p.category)){
	dv.header(3,group.key)
	dv.table(["Item", "Price"], group.rows.map(get_values))

}


```

## Оружие

```dataviewjs

let  weapons = await dv.io.csv("Mechanics/weapons.csv")
let my_csv = weapons



const nominal = { 
	copper: "мм",
	silver: "см",
	electrum: "эм",
	gold: "зм",
	plat: "пм"
}

const page = dv.current()
const is_haggled = page.is_haggled
const is_friend =page.is_friend
const trader_greed = page.trader_greed
const trader_normal = page.trader_normal
const trader_good = page.trader_good
// 
function eval_copper_price(price, nom) {
	switch (nom) {
		case nominal.copper:
			return price
		case nominal.silver:
			return price *10
		case nominal.electrum: 
			return price *50
		case nominal.gold:
			return price *100
		case nominal.platinum:
			return price * 1000
		default:
			return 0
	}
}

function format_price(price, nom) {
	if (price == 0){ return ""}
	price = Math.floor(price)
	return price.toString() + " " + nom
}


function price_stringify(price, nom) {
	price = Math.ceil(price)
	switch (nom) {
		case nominal.copper:
			return format_price(price, nom)
		case nominal.silver:
			return format_price(price/10 , nom) + " " + format_price(price %10, nominal.copper)
		case nominal.electrum: 
			return format_price(price/50 , nom) + " " + format_price(price % 50, nominal.copper)
		case nominal.gold:
			return format_price(price/100 , nom) + " " + format_price(price %100, nominal.silver)
		case nominal.platium:
			return format_price(price/1000 , nom) + " " + format_price(price %1000, nominal.gold)
		default:
			return 0
	}
}

function filter_for_trader(item_dict){

if (item_dict.price > 4000) {return false}
if (!item_dict.category == "No cat") {return false}
return true

}

function get_values(dict) {

	
	const item = dict.item
	const nom = dict.nom
	const weight = dict.weight
	let price = dict.price
	let copper_price = eval_copper_price(price, nom)
	
	if (!filter_for_trader({price: copper_price})) {return []}

	let trader_state_modifier = trader_greed
	if (is_friend) {trader_state_modifier = trader_good}
	else if (is_haggled){trader_state_modifier = trader_normal}
	
		const final_price = price_stringify(copper_price* trader_state_modifier, nom)
	
	let starting_price = price_stringify(copper_price*trader_greed, nom)
	let normal_price = price_stringify(copper_price*trader_normal, nom)
	let lowest_price = price_stringify(copper_price*trader_good,nom)
	return [item, final_price, dict.damage, dict.atributes]
}

for (let group of my_csv.groupBy(p => p.category)){
	dv.header(3,group.key)
	dv.table(["Item", "Price", "Damage", "Special"], group.rows.map(get_values))

}


```

## Доспехи

```dataviewjs

let  armor = await dv.io.csv("Mechanics/armor.csv")
let my_csv = armor

const nominal = { 
	copper: "мм",
	silver: "см",
	electrum: "эм",
	gold: "зм",
	plat: "пм"
}

const page = dv.current()
const is_haggled = page.is_haggled
const is_friend =page.is_friend
const trader_greed = page.trader_greed
const trader_normal = page.trader_normal
const trader_good = page.trader_good
// 
function eval_copper_price(price, nom) {
	switch (nom) {
		case nominal.copper:
			return price
		case nominal.silver:
			return price *10
		case nominal.electrum: 
			return price *50
		case nominal.gold:
			return price *100
		case nominal.platinum:
			return price * 1000
		default:
			return 0
	}
}

function format_price(price, nom) {
	if (price == 0){ return ""}
	price = Math.floor(price)
	return price.toString() + " " + nom
}


function price_stringify(price, nom) {
	price = Math.ceil(price)
	switch (nom) {
		case nominal.copper:
			return format_price(price, nom)
		case nominal.silver:
			return format_price(price/10 , nom) + " " + format_price(price %10, nominal.copper)
		case nominal.electrum: 
			return format_price(price/50 , nom) + " " + format_price(price % 50, nominal.copper)
		case nominal.gold:
			return format_price(price/100 , nom) + " " + format_price(price %100, nominal.silver)
		case nominal.platium:
			return format_price(price/1000 , nom) + " " + format_price(price %1000, nominal.gold)
		default:
			return 0
	}
}

function filter_for_trader(item_dict){

if (item_dict.price > 7000) {return false}
if (!item_dict.category == "No cat") {return false}
return true

}

function get_values(dict) {

	
	const item = dict.item
	const nom = dict.nom
	const weight = dict.weight
	let price = dict.price
	let copper_price = eval_copper_price(price, nom)
	
	if (!filter_for_trader({price: copper_price})) {return []}
	
	let trader_state_modifier = trader_greed
	if (is_friend) {trader_state_modifier = trader_good}
	else if (is_haggled){trader_state_modifier = trader_normal}
	
	const final_price = price_stringify(copper_price* trader_state_modifier, nom)

	let starting_price = price_stringify(copper_price*trader_greed, nom)
	let normal_price = price_stringify(copper_price*trader_normal, nom)
	let lowest_price = price_stringify(copper_price*trader_good,nom)
	
	return [item, final_price,dict.class, dict.strength_req,
	 dict.stealth]
}

for (let group of my_csv.groupBy(p => p.category)){
	dv.header(3,group.key)
	dv.table(["Item", "Price", "Armor Class", "Strengh required", "Stealth effect"], group.rows.map(get_values))

}


```